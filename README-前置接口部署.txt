========================================
  前置接口功能 - 立即部署
========================================

✅ 所有代码已修复完成！

现在只需执行以下 3 步即可完成部署：

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
步骤 1: 安装 Python 依赖
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

cd /Users/lihui/Work/cursor/dm-brain/apitest/platform/backend
source venv/bin/activate
pip install jsonpath-ng==1.6.1

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
步骤 2: 执行数据库迁移
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

mysql -u root -p apitest < backend/migrate_add_pre_request.sql

（输入 MySQL root 密码）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
步骤 3: 刷新浏览器
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

前端已自动热更新，只需刷新浏览器即可！
后端也不需要重启（除非想看日志输出）

访问: http://localhost:44321

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
验证部署
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 选择任意接口
2. 点击"添加测试数据"
3. 应该看到"前置接口配置"区域

如果看到了，说明部署成功！ 🎉

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
快速测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 为登录接口创建测试数据：
   - 接口: POST /admin-api/system/auth/login
   - Body: {"username": "admin", "password": "admin123", ...}
   - 保存

2. 为业务接口创建测试数据：
   - 前置接口: 选择登录接口
   - 变量提取: accessToken -> $.data.accessToken
   - 请求头: {"Authorization": "Bearer {{accessToken}}"}
   - 保存并执行

3. 查看后端日志，应该看到：
   🔄 执行前置接口...
   ✅ 前置接口执行成功，提取变量: ['accessToken']

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
文档位置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 部署前置接口功能.md - 详细部署指南
2. 前置接口功能使用指南.md - 完整使用说明
3. QUICKSTART-前置接口.md - 快速开始
4. backend/migrate_add_pre_request.sql - 数据库迁移脚本

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
遇到问题？
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 前端编译错误 → 已修复，刷新浏览器即可
2. 数据库字段不存在 → 重新执行步骤 2
3. 变量未提取 → 检查 JSONPath 是否正确
4. 其他问题 → 查看后端日志

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

祝使用愉快！ 🚀
